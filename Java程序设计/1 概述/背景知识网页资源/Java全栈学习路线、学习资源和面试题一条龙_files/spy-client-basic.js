!function(t,e){(t=t||self).SpyClient=e()}(this,function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}function n(t){return t&&t.Math==Math&&t}function u(t){try{return!!t()}catch(t){return!0}}function o(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function r(t){return m.call(t).slice(8,-1)}function i(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function c(t){return O(i(t))}function a(t){return"object"==typeof t?null!==t:"function"==typeof t}function f(t,e){if(!a(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!a(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}function s(t,e){return S.call(t,e)}function l(t){if(!a(t))throw TypeError(String(t)+" is not an object");return t}function p(e,n){try{P(h,e,n)}catch(t){h[e]=n}return n}var h=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")(),d=!u(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),y={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,v={f:g&&!y.call({1:2},1)?function(t){var e=g(this,t);return!!e&&e.enumerable}:y},m={}.toString,b="".split,O=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==r(t)?b.call(t,""):Object(t)}:Object,S={}.hasOwnProperty,k=h.document,j=a(k)&&a(k.createElement),w=!d&&!u(function(){return 7!=Object.defineProperty(function(t){return j?k.createElement(t):{}}("div"),"a",{get:function(){return 7}}).a}),x=Object.getOwnPropertyDescriptor,C={f:d?x:function(t,e){if(t=c(t),e=f(e,!0),w)try{return x(t,e)}catch(t){}if(s(t,e))return o(!v.f.call(t,e),t[e])}},E=Object.defineProperty,A={f:d?E:function(t,e,n){if(l(t),e=f(e,!0),l(n),w)try{return E(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},P=d?function(t,e,n){return A.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t},M="__core-js_shared__",T=h[M]||p(M,{}),D=Function.toString;"function"!=typeof T.inspectSource&&(T.inspectSource=function(t){return D.call(t)});function _(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++B+G).toString(36)}var I,z,L,N,F=T.inspectSource,R=h.WeakMap,Z="function"==typeof R&&/native code/.test(F(R)),q=e(function(t){(t.exports=function(t,e){return T[t]||(T[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})}),B=0,G=Math.random(),K=q("keys"),U={},W=h.WeakMap;if(Z){var $=new W,J=$.get,Q=$.has,V=$.set;I=function(t,e){return V.call($,t,e),e},z=function(t){return J.call($,t)||{}},L=function(t){return Q.call($,t)}}else{var Y=K[N="state"]||(K[N]=_(N));U[Y]=!0,I=function(t,e){return P(t,Y,e),e},z=function(t){return s(t,Y)?t[Y]:{}},L=function(t){return s(t,Y)}}function H(t){return"function"==typeof t?t:void 0}function X(t,e){return arguments.length<2?H(yt[t])||H(h[t]):yt[t]&&yt[t][e]||h[t]&&h[t][e]}function tt(t){return isNaN(t=+t)?0:(0<t?vt:gt)(t)}function et(t){return 0<t?mt(tt(t),9007199254740991):0}function nt(a){return function(t,e,n){var r,o=c(t),i=et(o.length),u=function(t,e){var n=tt(t);return n<0?bt(n+e,0):Ot(n,e)}(n,i);if(a&&e!=e){for(;u<i;)if((r=o[u++])!=r)return!0}else for(;u<i;u++)if((a||u in o)&&o[u]===e)return a||u||0;return!a&&-1}}function rt(t,e){var n,r=c(t),o=0,i=[];for(n in r)!s(U,n)&&s(r,n)&&i.push(n);for(;e.length>o;)s(r,n=e[o++])&&(~kt(i,n)||i.push(n));return i}function ot(t,e){for(var n=Et(e),r=A.f,o=C.f,i=0;i<n.length;i++){var u=n[i];s(t,u)||r(t,u,o(e,u))}}function it(t,e){var n=Mt[Pt(t)];return n==Dt||n!=Tt&&("function"==typeof e?u(e):!!e)}function ut(t,e){var n,r,o,i,u,a=t.target,c=t.global,f=t.stat;if(n=c?h:f?h[a]||p(a,{}):(h[a]||{}).prototype)for(r in e){if(i=e[r],o=t.noTargetGet?(u=It(n,r))&&u.value:n[r],!_t(c?r:a+(f?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;ot(i,o)}(t.sham||o&&o.sham)&&P(i,"sham",!0),dt(n,r,i,t)}}function at(t){return Object(i(t))}function ct(t,e,n){var r=f(e);r in t?A.f(t,r,o(0,n)):t[r]=n}function ft(t){return s(Ft,t)||(Lt&&s(Rt,t)?Ft[t]=Rt[t]:Ft[t]=Zt("Symbol."+t)),Ft[t]}function st(t,e){var n;return zt(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!zt(n.prototype)?a(n)&&null===(n=n[qt])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}var lt,pt,ht={set:I,get:z,has:L,enforce:function(t){return L(t)?z(t):I(t,{})},getterFor:function(n){return function(t){var e;if(!a(t)||(e=z(t)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return e}}},dt=e(function(t){var e=ht.get,a=ht.enforce,c=String(String).split("String");(t.exports=function(t,e,n,r){var o=!!r&&!!r.unsafe,i=!!r&&!!r.enumerable,u=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof e||s(n,"name")||P(n,"name",e),a(n).source=c.join("string"==typeof e?e:"")),t!==h?(o?!u&&t[e]&&(i=!0):delete t[e],i?t[e]=n:P(t,e,n)):i?t[e]=n:p(e,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||F(this)})}),yt=h,gt=Math.ceil,vt=Math.floor,mt=Math.min,bt=Math.max,Ot=Math.min,St={includes:nt(!0),indexOf:nt(!1)},kt=St.indexOf,jt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],wt=jt.concat("length","prototype"),xt={f:Object.getOwnPropertyNames||function(t){return rt(t,wt)}},Ct={f:Object.getOwnPropertySymbols},Et=X("Reflect","ownKeys")||function(t){var e=xt.f(l(t)),n=Ct.f;return n?e.concat(n(t)):e},At=/#|\.prototype\./,Pt=it.normalize=function(t){return String(t).replace(At,".").toLowerCase()},Mt=it.data={},Tt=it.NATIVE="N",Dt=it.POLYFILL="P",_t=it,It=C.f,zt=Array.isArray||function(t){return"Array"==r(t)},Lt=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())}),Nt=Lt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ft=q("wks"),Rt=h.Symbol,Zt=Nt?Rt:Rt&&Rt.withoutSetter||_,qt=ft("species"),Bt=X("navigator","userAgent")||"",Gt=h.process,Kt=Gt&&Gt.versions,Ut=Kt&&Kt.v8;Ut?pt=(lt=Ut.split("."))[0]+lt[1]:Bt&&(!(lt=Bt.match(/Edge\/(\d+)/))||74<=lt[1])&&(lt=Bt.match(/Chrome\/(\d+)/))&&(pt=lt[1]);function Wt(e){return 51<=Jt||!u(function(){var t=[];return(t.constructor={})[Qt]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function $t(t){if(!a(t))return!1;var e=t[Vt];return void 0!==e?!!e:zt(t)}var Jt=pt&&+pt,Qt=ft("species"),Vt=ft("isConcatSpreadable"),Yt=9007199254740991,Ht="Maximum allowed index exceeded",Xt=51<=Jt||!u(function(){var t=[];return t[Vt]=!1,t.concat()[0]!==t}),te=Wt("concat");ut({target:"Array",proto:!0,forced:!Xt||!te},{concat:function(t){var e,n,r,o,i,u=at(this),a=st(u,0),c=0;for(e=-1,r=arguments.length;e<r;e++)if($t(i=-1===e?u:arguments[e])){if(o=et(i.length),Yt<c+o)throw TypeError(Ht);for(n=0;n<o;n++,c++)n in i&&ct(a,c,i[n])}else{if(Yt<=c)throw TypeError(Ht);ct(a,c++,i)}return a.length=c,a}});function ee(t,e){var n=[][t];return!!n&&u(function(){n.call(null,e||function(){throw 1},1)})}function ne(t){throw t}function re(t,e){if(s(ie,t))return ie[t];var n=[][t],r=!!s(e=e||{},"ACCESSORS")&&e.ACCESSORS,o=s(e,0)?e[0]:ne,i=s(e,1)?e[1]:void 0;return ie[t]=!!n&&!u(function(){if(r&&!d)return!0;var t={length:-1};r?oe(t,1,{enumerable:!0,get:ne}):t[1]=1,n.call(t,o,i)})}var oe=Object.defineProperty,ie={},ue=St.indexOf,ae=[].indexOf,ce=!!ae&&1/[1].indexOf(1,-0)<0,fe=ee("indexOf"),se=re("indexOf",{ACCESSORS:!0,1:0});ut({target:"Array",proto:!0,forced:ce||!fe||!se},{indexOf:function(t,e){return ce?ae.apply(this,arguments)||0:ue(this,t,1<arguments.length?e:void 0)}});var le=[].join,pe=O!=Object,he=ee("join",",");ut({target:"Array",proto:!0,forced:pe||!he},{join:function(t){return le.call(c(this),void 0===t?",":t)}});function de(r,o,t){if(function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function")}(r),void 0===o)return r;switch(t){case 0:return function(){return r.call(o)};case 1:return function(t){return r.call(o,t)};case 2:return function(t,e){return r.call(o,t,e)};case 3:return function(t,e,n){return r.call(o,t,e,n)}}return function(){return r.apply(o,arguments)}}function ye(h){var d=1==h,y=2==h,g=3==h,v=4==h,m=6==h,b=5==h||m;return function(t,e,n,r){for(var o,i,u=at(t),a=O(u),c=de(e,n,3),f=et(a.length),s=0,l=r||st,p=d?l(t,f):y?l(t,0):void 0;s<f;s++)if((b||s in a)&&(i=c(o=a[s],s,u),h))if(d)p[s]=i;else if(i)switch(h){case 3:return!0;case 5:return o;case 6:return s;case 2:ge.call(p,o)}else if(v)return!1;return m?-1:g||v?v:p}}var ge=[].push,ve={forEach:ye(0),map:ye(1),filter:ye(2),some:ye(3),every:ye(4),find:ye(5),findIndex:ye(6)}.map,me=Wt("map"),be=re("map");ut({target:"Array",proto:!0,forced:!me||!be},{map:function(t,e){return ve(this,t,1<arguments.length?e:void 0)}}),ut({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Oe=Date.prototype,Se="Invalid Date",ke="toString",je=Oe[ke],we=Oe.getTime;new Date(NaN)+""!=Se&&dt(Oe,ke,function(){var t=we.call(this);return t==t?je.call(this):Se});var xe=Object.keys||function(t){return rt(t,jt)},Ce=Object.assign,Ee=Object.defineProperty,Ae=!Ce||u(function(){if(d&&1!==Ce({b:1},Ce(Ee({},"a",{enumerable:!0,get:function(){Ee(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Ce({},t)[n]||xe(Ce({},e)).join("")!=r})?function(t,e){for(var n=at(t),r=arguments.length,o=1,i=Ct.f,u=v.f;o<r;)for(var a,c=O(arguments[o++]),f=i?xe(c).concat(i(c)):xe(c),s=f.length,l=0;l<s;)a=f[l++],d&&!u.call(c,a)||(n[a]=c[a]);return n}:Ce;function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ut({target:"Object",stat:!0,forced:Object.assign!==Ae},{assign:Ae}),ut({target:"Object",stat:!0,forced:u(function(){xe(1)})},{keys:function(t){return xe(at(t))}});var Me,Te,De,_e=/(iPhone|iPod|iPad)/.test(navigator.userAgent);function Ie(t){console.error("[SpyClient_log]".concat(t))}function ze(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ze),this.sample={},this.markCache={},!t.pid)throw new Error("pid is required");this.option={pid:t.pid,lid:t.lid,check:!1!==t.check,sample:t.sample,logServer:t.logServer||"https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/mwb2.gif?"}}return Me=ze,(Te=[{key:"send",value:function(t){if(this.check(t)){if("number"==typeof t.sample){if(Math.random()>t.sample)return}else if("number"==typeof this.option.sample&&Math.random()>this.option.sample)return;delete(t=Object.assign({pid:this.option.pid,lid:this.option.lid,ts:Date.now(),group:"common"},t)).sample;var e=this.option.logServer+function(n){return Object.keys(n).map(function(t){var e=n[t];return void 0===e?e="":"string"!=typeof e&&(e=JSON.stringify(e)),encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")}(t);!_e&&navigator.sendBeacon&&navigator.sendBeacon(e)||((new Image).src=e)}}},{key:"check",value:function(t){if(!this.option.check)return!0;var e=["perf","except","dist","count"];if(-1===e.indexOf(t.type))return Ie("type only is one of "+e.join(", ")),!1;if(t.group&&30<t.group.length)return Ie("group length execeeds 30"),!1;var n=/^[a-zA-Z0-9-_]{0,30}$/;if("except"===t.type){if("string"!=typeof t.info.msg||!t.info.msg.length)return Ie("info.msg field must be not empty and is String"),!1}else for(var r=0,o=Object.keys(t.info);r<o.length;r++){var i=o[r];if(!n.test(i))return Ie("info.".concat(i," is unexpected. ")+"Length must be not more than 30. Supported chars: a-zA-Z0-9-_"),!1;var u=t.info[i];if("dist"===t.type){if(30<u.length)return Ie("info.".concat(i," value length execeeds 30 when type == 'dist'")),!1}else if("number"!=typeof u)return Ie("info.".concat(i," value must be number")),!1}if(t.dim)for(var a=0,c=Object.keys(t.dim);a<c.length;a++){var f=c[a];if(!n.test(f))return Ie("dim key [".concat(f,"] is unexpected. ")+"Length must be not more than 30. Supported chars: a-zA-Z0-9-_"),!1;var s=t.dim[f];if(!/^[a-zA-Z0-9\-_\*\.\s\/#\+@\&\u4e00-\u9fa5]{0,30}$/.test(s))return Ie("dim.".concat(f," value [").concat(s,"] is unexpected. ")+"Length must be not more than 30. Supported chars: a-zA-Z0-9-_*. /#+@& and Chinese"),!1}return!0}},{key:"sendPerf",value:function(t){this.send(Object.assign({type:"perf"},t))}},{key:"sendExcept",value:function(t){this.send(Object.assign({type:"except"},t))}},{key:"sendDist",value:function(t){this.send(Object.assign({type:"dist"},t))}},{key:"sendCount",value:function(t){this.send(Object.assign({type:"count"},t))}},{key:"sendExceptForError",value:function(t,e){var n=Object.assign({},e);n.info=Object.assign({},e.info||{},{msg:t.message,stack:t.stack}),this.sendExcept(n)}},{key:"startMark",value:function(t){this.markCache[t]={start:Date.now()}}},{key:"endMark",value:function(t){return this.markCache[t]?(this.markCache[t].total=Date.now()-this.markCache[t].start,this.markCache[t].total):0}},{key:"clearMark",value:function(t){this.markCache[t]&&delete this.markCache[t]}},{key:"getAllMark",value:function(){for(var t={},e=0,n=Object.keys(this.markCache);e<n.length;e++){var r=n[e];t[r]=this.markCache[r].total}return t}},{key:"clearAllMark",value:function(){this.markCache={}}}])&&Pe(Me.prototype,Te),void(De&&Pe(Me,De)),ze});