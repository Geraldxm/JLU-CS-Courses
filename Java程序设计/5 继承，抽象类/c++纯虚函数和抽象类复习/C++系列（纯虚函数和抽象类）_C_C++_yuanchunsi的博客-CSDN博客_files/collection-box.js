!function(e){window.jQuery?e(window.csdn=window.csdn||{},void 0):function(){!window.jQuery&&function(){var t=document.createElement("script"),o=document.getElementById("collection-script")||document.head.lastElementChild||document.head.lastChild;t.src="//csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js",t.type="text/javascript";var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://g.csdnimg.cn/user-login/2.2.4/user-login.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(n,c),myDOM=o.previousElementSibling||o.previousSibling,t.onload=function(){e(window.csdn=window.csdn||{},void 0)},document.body.insertBefore(t,o)}()}()}(function(e,t){function o(e){var t=!0,o=function(e){if(e?"url"in e&&""!==e.url?"source"in e&&""!==e.source?"source_id"in e&&""!==e.source_id?"author"in e&&""!==e.author?"title"in e&&""!==e.title||(console.warn("调用请提供标题信息"),t=!1):(console.warn("调用请提供访问用户作者信息"),t=!1):(console.warn("调用请提供访问来源source_id！"),t=!1):(console.warn("调用请提供访问来源类型！"),t=!1):(console.warn("调用请提供访问来源地址！"),t=!1):(console.warn("调用请提供访问需设参数！"),t=!1),!1===t)return!1};if(!c.COLLECTION.params&&o(e),c.COLLECTION.params){if(e&&t){for(var n in e)c.COLLECTION.params[n]=e[n];o(c.COLLECTION.params)}}else t&&(c.COLLECTION.params=e);return t}function n(e){var t=c.COLLECTION.params.url;c.ajax({type:"get",url:u.requestHostName+"/api/favorite/check?url="+t,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(t){if(200===t.code){var o=Array.from(new Set(Object.values(t.data)));e(1==o.length&&0==o[0]||0==o.length?!1:!0)}},error:function(e){var t;if(e){try{t=JSON.parse(e.responseText).message}catch(o){t=e.statusText}E(t||"获取收藏状态失败!")}}})}var c=window.jQuery||{},l=t,r=t,i=window.document,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://g.csdnimg.cn/user-login/2.2.4/user-login.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(a,s);var u={baseUrl:"//g.csdnimg.cn/collection-box/",userTag:"UserName",ads:"//g.csdnimg.cn/collection-box/1.1.7/collection-box.css",collectionTag:"[data-bind-collection=true]",prefixStyleTag:"g-",styleTag:"collection-box",status:{create:"add-collection",list:"list-collection"},requestHostName:"//me.csdn.net",messageInfoTimer:1800};e.collectionBox=e.collectionBox?e.collectionBox:{},c===window.jQuery?(r=function(e,t){var o=[];return c(t,e).each(function(e,t){o.push(t)}),o},function(e){return c(e,i).get(0)},l=!0):r=function(e){return i.querySelectorAll(e)},c.COLLECTION={version:"1.1.7",v:"1.1.2"},c.COLLECTION.labels={currentTab:"add-collection"},e.collectionBox.params&&o(e.collectionBox.params),e.collectionBox.scope=c.COLLECTION;var d=function(e){var t=document.cookie;return t&&function(){var o,n={};t=t.split("; ");for(var c=0,l=t.length;c<l&&(o=t[c].split("="),!(o.length>0&&(o[0]===e&&(n.key=o[0],n.value=o[1],n.status=!0),"key"in n)));c++);return"key"in n&&n}()},m=function(e){return e.replace(/^\s*/g,"").replace(/\s*$/g,"")},C=function(e,t,o){window.addEventListener?function(){e.addEventListener(t,o,!1)}():function(){e.attachEvent("on"+t,o)}()},f=function(e,t,o){window.removeEventListener?function(){e.removeEventListener(t,o,!1)}():function(){e.detachEvent("on"+t,o)}()},L=function(){var e,t=i.head,o=t.firstElementChild||t.firstChild,n=i.createElement("link");return n.rel="stylesheet",n.type="text/css",n.href=u.ads,e=t.insertBefore(n,o),c.COLLECTION.linkCss=e,!!e},O=function(e){var t,o;e||(e=c.COLLECTION.labels.currentTab),"add-collection"===e?(t=new RegExp("(s*g-collection([^-]|$))","g"),o=" g-create"):"list-collection"===e&&(t=new RegExp("(s*g-create([^-]|$))","g"),o=" g-collection"),c.COLLECTION.collectionDom.className=c.COLLECTION.collectionDom.className.replace(t,o)},g=function(){var e,t=c.COLLECTION.formGroup,o=t.querySelector(".form-title")||i.getElementById("g-form-title"),n=t.querySelector(".form-des")||i.getElementById("g-form-des"),l=t.querySelector(".form-check")||i.getElementById("g-form-checks");if(o.value&&(o.value=""),n.value&&(n.value=""),l){var r=l.getElementsByTagName("input");r&&(r[0].checked=!0)}if(c.COLLECTION.formError.length>0)for(;e=c.COLLECTION.formError.shift();)e.eleTag&&delete e.isCreate&&e.removeChild(e.eleTag)},p=e.collectionBox.getState=function(t,o){return window.csdn.userLogin.loadAjax(function(e){o||(o="list"),"list"===o&&g(),c.COLLECTION.labels.currentTab=u.status[o],O()}),e.collectionBox},v=function(e){for(var t,o=0,n="";t=e[o];)n+=function(e){return'<li><span class="title"><a href="###">'+e.Name+'</a></span><em class="info"><i>'+e.FavoriteNum+'</i>条内容</em><a href="" class="btn-collect btn-collect-pos '+(e.CheckStatus>0?"btn-uncollected":"btn-collected")+'" data-id="'+e.ID+'" name="collection-btn"'+(e.CheckStatus>0?"data-checkId="+e.CheckStatus:"")+">"+(e.CheckStatus>0?"已收藏":"收藏")+"</a></li>"}(t),o++;return n},E=function(e){var t=c(c.COLLECTION.gMessage);t.text(e),t.addClass("g-fadeInDown"),setTimeout(function(){t.removeClass("g-fadeInDown")},u.messageInfoTimer)},N=function(){var t={};c.COLLECTION.formError=[];var o,n,l,r,a,s,d,f={title:{reg:"([^\\s*]+){2,20}",min:2,max:20,msg:"长度在 2 到 20 个字符"}},L=function(e){var t=e.msg,o=e.pos;return o&&!o.isCreate?function(){var e=i.createElement("div");return e.className="g-collection-error",e.innerHTML=t,o.isCreate=!0,e}():function(){var e=o.querySelector(".g-collection-error");return e&&(e.innerHTML=t),e}()},O=function(e){var t,o,n=0,l=!1,r=e.pos,i=e.msg;if(!r)return!1;if(o=i&&L(e)){for(r.appendChild(o),r.eleTag=o;t=c.COLLECTION.formError[0];){if(t===r){l=!0;break}n++}!l&&c.COLLECTION.formError.push(r)}else{var o=r.querySelector(".g-collection-error")||c(".g-collection-error",r).get(0);if(o&&!i)for(r.removeChild(o),delete r.eleTag,delete r.isCreate;t=c.COLLECTION.formError[n];){if(t===r){c.COLLECTION.formError.splice(n,1);break}n++}}},g=c.COLLECTION.formGroup,p=c.COLLECTION.formBtns;if(!p||!g)return console.warn("collection option is fail!"),!1;o=g.querySelector(".form-title")||c("#g-form-title",g).get(0),n=g.querySelector(".form-des")||c("#g-form-des",g).get(0),l=g.querySelector(".form-check")||c("#g-form-checks",g).get(0),r=p.querySelector(".btn-confirm")||c("#g-btn-confirm",p).get(0),a=p.querySelector(".btn-reset")||c("#g-btn-reset",p).get(0),s=function(e){var t,o,n,c,l=m(e&&e.value||this.value),i=m(e&&e.value||this.value),a=e&&e.getAttribute("data-name")||this.getAttribute("data-name"),s=!0;a&&(a=f[a]),t=a.reg&&new RegExp(a.reg,"g"),c=a.reg&&a.msg||"格式不正确",o=a.min,n=a.max,t&&(i=i.match(t))&&(i=i[0]),i?(o||n)&&(l.length<o||l.length>n)&&(s=!1):s=!1,!1===s?r.isNoSub=!0:delete r.isNoSub,"function"==typeof O&&O(!1===s?{msg:c,pos:this.parentNode}:{pos:this.parentNode})},d=function(){var r=l.getElementsByTagName("input");if(t.name=m(o.value),t.description=m(n.value),t.source=c.COLLECTION.params.source,t.is_private=r.length>0&&(r[0].checked?0:1),!c.ajax)return console.warn("请导入jquery, 发起请求"),!1;c.ajax({type:"post",url:u.requestHostName+"/api/favorite/createFolder",data:JSON.stringify(t),crossDomain:!0,xhrFields:{withCredentials:!0},success:function(t){if(200===t.code){var o=t.data,n=v([o]);E("创建成功!"),h(n,"single"),e.collectionBox.getState(null,"list"),T()}},error:function(e){var t;if(e){try{t=JSON.parse(e.responseText).message}catch(o){t=e.statusText}E(t||"创建失败!")}}})},o.onblur=function(){var e=this;s.call(e)},r&&C(r,"click",function(){if(o.focus(),o.blur(),r.isNoSub)return!1;d()}),a&&C(a,"click",function(){e.collectionBox.close()})},T=function(){var t;c(".btn-collect","#g-collection-list").off("click"),c(".btn-collect","#g-collection-list").on("click",function(o){var l={},r=c(this),i=Number(c(this).attr("data-id"),10),a=Number(c(this).attr("data-checkId"),10);if(c(this).hasClass("btn-collected")){if(t=u.requestHostName+"/api/favorite/create",!(c.COLLECTION.params.url&&c.COLLECTION.params.title&&c.COLLECTION.params.author&&c.COLLECTION.params.source&&c.COLLECTION.params.source_id))return alert("缺少提交参数!"),!1;l.url=c.COLLECTION.params.url,l.title=c.COLLECTION.params.title,l.description=c.COLLECTION.params.description||"",l.author=c.COLLECTION.params.author,l.source=c.COLLECTION.params.source,l.source_id=Number(c.COLLECTION.params.source_id,10),l.folder_id=i,r.isCollect=!0}else if(c(this).hasClass("btn-uncollected")){if(t=u.requestHostName+"/api/favorite/delete",!c.COLLECTION.params.source)return alert("缺少提交参数!"),!1;l.source=c.COLLECTION.params.source,a&&(l.ids=[a]),r.isCollect=!1}return c.ajax({type:"post",url:t,data:JSON.stringify(l),crossDomain:!0,xhrFields:{withCredentials:!0},success:function(t){var o=r.closest("li").find(".info i"),c=Number(o.html(),10)||0;200===t.code&&(r.isCollect?(r.attr("data-checkId",t.data.ID).removeClass("btn-collected").addClass("btn-uncollected").text("已收藏"),c+=1):(r.removeAttr("data-checkId").removeClass("btn-uncollected").addClass("btn-collected").text("收藏"),c-=1),o.html(c),e.collectionBox.params.collectionCallBack&&n(e.collectionBox.params.collectionCallBack))},error:function(e){var t;if(e){try{t=JSON.parse(e.responseText).message}catch(o){t=e.statusText}E(t||"操作失败!")}}}),!1})},h=function(e,t){var o,n,l=c.COLLECTION.collectionList;l&&("single"===t?(l.className=l.className.replace(/hide/g,""),n=i.createElement("ul"),n.innerHTML=e,n=n.firstElementChild||n.firstChild,o=l.firstElementChild||l.firstChild||null,e&&l.insertBefore(n,o)):e&&(l.innerHTML="",l.innerHTML=e))},b=function(e){var t,o,n,l,r,a=u.prefixStyleTag?u.prefixStyleTag:"g-";return o='<div class="g-collection-box g-collection-skin '+u.styleTag+("add-collection"===c.COLLECTION.labels.currentTab?" g-collection":"")+'"><span class="'+a+'close-btn" id="g-close-btn">&times</span><div class="collection-title '+a+'collection-title">添加收藏</div><div class="collection-title '+a+'create-title">新建收藏夹</div><div class="collection-content"><ul class="list '+(e?"":"hide")+'" id="g-collection-list">'+(e||"")+'</ul><div class="collection-blank '+(e?"hide":"")+'"><span class="g-monkey"><img src="'+u.baseUrl+c.COLLECTION.version+'/images/monkey-pixel.svg" alt="no result"></span><em>没有收藏列表内容！</em></div><div class="'+a+'collection-form" id="g-collection-form"><div class="'+a+'form-control"><label class="label-title" for="g-form-title">标题</label><input data-name="title" tabindex="1" class="'+a+'form-control-text form-title" id="g-form-title" placeholder="请填写收藏夹的名称" type="text"/></div><div class="'+a+'form-control"><label class="label-title" for="g-form-des">描述（选填）</label><textarea data-name="des" class="'+a+'form-control-text form-des" id="g-form-des" placeholder="请填写收藏夹的名称" rows="8"></textarea></div><div class="'+a+"form-control "+a+'form-control-private"><label class="label-title">私密</label><span class="check-group form-check" id="g-form-checks"><span><input type="radio" name="radios" id="public-radio" value="0" checked/> <label for="public-radio">公开 所有人可见</label></span><span><input type="radio" name="radios" id="private-radio" value="1"/> <label for="private-radio">私密 只有你可以查看这个收藏夹</label></span></span></div></div></div><div class="'+a+'btn-group" id="g-btn-group"><a href="javascript:void(0);" class="btn-add-collection '+a+'btn" onclick="window.csdn.collectionBox.getState(this, \'create\');">+ 新建收藏夹</a><a href="javascript:void(0);" id="g-btn-back" class="btn-back '+a+'btn" onclick="window.csdn.collectionBox.getState(this, \'list\');">返回</a><a href="javascript:void(0);" id="g-btn-reset" class="btn-reset '+a+'btn">取消</a><a href="javascript:void(0);" id="g-btn-confirm" class="btn-confirm '+a+'btn">确定</a></div></div>',n=i.body,l=i.createDocumentFragment(),r=i.createElement("div"),r.className="g-collection-mark",r.innerHTML=o+'<span class="g-collection-message" id="g-collection-message"></span>',c.COLLECTION.fragmentDom=l,c.COLLECTION.htmlDom=r,c.COLLECTION.collectionDom=r.firstElementChild||r.firstChild,c.COLLECTION.closeBtn=c.COLLECTION.collectionDom.querySelector("."+a+"close-btn")||c.COLLECTION.collectionDom.children[0],c.COLLECTION.collectionList=c.COLLECTION.collectionDom.querySelector(".list")||c("#g-collection-list",c.COLLECTION.collectionDom).get(0),c.COLLECTION.formGroup=c.COLLECTION.collectionDom.querySelector("."+a+"collection-form")||c("#g-collection-form",c.COLLECTION.collectionDom).get(0),c.COLLECTION.formBtns=c.COLLECTION.collectionDom.querySelector("."+a+"btn-group")||c("#g-btn-group",c.COLLECTION.collectionDom).get(0),c.COLLECTION.gMessage=r.lastElementChild||r.lastChild,c.COLLECTION.collectionDom.isCreate=!0,l.appendChild(r),t=n.appendChild(l),N(),t},I=function(e,t){var o=c.COLLECTION.params.url;c.ajax({type:"get",url:u.requestHostName+"/api/favorite/folderListWithCheck?url="+o,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(o){var n,l;200===o.code&&o.data&&(n=o.data.result,l=v(n),!c.COLLECTION.collectionDom||c.COLLECTION.collectionDom&&!c.COLLECTION.collectionDom.isCreate?e(l):h(l),t())},error:function(e){var t;if(e){try{t=JSON.parse(e.responseText).message}catch(o){t=e.statusText}E(t||"获取收藏列表失败!")}}})},y=function(e,t){var o;return o="all"===e?"none":"block","start"===e&&(o="block"),c.COLLECTION.collectionDom&&(c.COLLECTION.collectionDom.parentNode.style.display=o,c.COLLECTION.collectionDom.status="block"===o||(c.COLLECTION.runStatus=!0,!1)),c.COLLECTION.collectionDom.status&&t&&t(),c.COLLECTION},x=function(){var e=function(e){var t=e||window.event;if(c.COLLECTION.collectionDom.status&&t.target===this)return y("all"),p(),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),!1};c.COLLECTION.collectionDom.parentNode&&!c.COLLECTION.collectionDom.parentNode.isClick&&(f(c.COLLECTION.collectionDom.parentNode,"click",e),C(c.COLLECTION.collectionDom.parentNode,"click",e),c.COLLECTION.collectionDom.parentNode.isClick=!0),c.COLLECTION.closeBtn&&!c.COLLECTION.closeBtn.isCloseClick&&(f(c.COLLECTION.closeBtn,"click",e),C(c.COLLECTION.closeBtn,"click",e),c.COLLECTION.closeBtn.isCloseClick=!0)},w=function(e){var n=(!c.COLLECTION.collectionDom||c.COLLECTION.collectionDom&&!c.COLLECTION.collectionDom.isCreate)&&!c.COLLECTION.linkCss&&L();if(!1===o(e))return console.warn("调用失败！"),!1;n?I(b,function(){y(t),x(),T()}):c.COLLECTION.collectionDom&&I(h,function(){y(t),T()})},k=function(){var e=c(u.collectionTag,i)||r(i,u.collectionTag);return l?c(i).on("click",u.collectionTag,function(e){var t=e||window.event;return window.csdn.userLogin.loadAjax(function(e){w()}),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),t.returnValue?t.returnValue=!1:t.preventDefault(),!1}):e.length>0&&function(){c.COLLECTION.collectionBtns=e;for(var t=function(e){var t=e||window.event;window.csdn.userLogin.loadAjax(function(e){w()}),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),t.returnValue?t.returnValue=!1:t.preventDefault()},o=0;e[o];)!function(o){var n=e[o];C(n,"click",t)}(o),o++}(),!0};e.collectionBox.close=function(){return!c.COLLECTION.collectionDom||c.COLLECTION.collectionDom&&!c.COLLECTION.collectionDom.status?e.collectionBox:(c.COLLECTION.collectionDom.status&&(p(),y("all")),e.collectionBox)},e.collectionBox.show=function(t){return window.csdn.userLogin.loadAjax(function(e){w(t)}),e.collectionBox};var B,D=function(){k()},S=function(){if(result=d(u.userTag),!result||result&&!result.status)return!1;D()},j=function(){S()},q=function(e){var t=!1,o=function(){t||(t=!0,e&&e())},n=function(){try{i.documentElement.doScroll("left")}catch(e){return void setTimeout(n,50)}o()};n(),i.onreadystatechange=function(){"complete"===i.readyState&&(i.onreadystatechange=null,o())}},H=function(e){document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(function(){e&&e()},0):(B=function(){document.removeEventListener("DOMContentLoaded",B,!1),e()},document.addEventListener("DOMContentLoaded",B,!1)):document.attachEvent&&q(e)};_ready=function(){l&&c(function(){j()})||H(j)},_ready()});